<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="DYNAMICS is a library of routines used for the analysis of dynamic systems.">
    <meta name="author" content="Jason Christopherson" >
    <link rel="icon" href="../favicon.png">

    <title>fit_frf &ndash; DYNAMICS</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">DYNAMICS </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>fit_frf
      <small>Function</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 7.8% of total for procedures.">92 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dynamics_frequency_response.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/dynamics_frequency_response.f90.html'>dynamics_frequency_response.f90</a></li>
              <li><a href='../module/dynamics_frequency_response.html'>dynamics_frequency_response</a></li>
          <li class="active">fit_frf</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  function fit_frf(mt, n, freq, rsp, maxp, minp, init, stats, alpha, controls, settings, info, err) result(rst)  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li>peaks</li>
            </ul>
          </li>
      </ul>
    </div>


    <p>Fits an experimentally obtained frequency response by model for either a
receptance model:</p>
<p>
<script type="math/tex; mode=display"> H(\omega) = \sum_{i=1}^{n} \frac{A_{i}}{\omega_{ni}^{2} - 
\omega^{2} + 2 j \zeta_{i} \omega_{ni} \omega} </script>
</p>
<p>or an accelerance model:</p>
<p>
<script type="math/tex; mode=display"> H(\omega) = \sum_{i=1}^{n} \frac{-A_{i} \omega^{2}}{\omega_{ni}^{2} - 
\omega^{2} + 2 j \zeta_{i} \omega_{ni} \omega} </script>.</p>
<p>Internally, the code uses a Levenberg-Marquardt solver to determine the
parameters.  The initial guess for the solver is determined by a 
peak finding algorithm used to locate the resonant modes in frequency.
from this result, estimates for both the amplitude and natural frequency
values are obtained.  The damping parameters are assumed to be equal
for all modes and set to a default value of 0.1.</p>

    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
<th>Intent</th><th>Optional</th>        <th>Attributes</th>
        <th></th>
        <th>Name</th>
        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-mt"></span>
              integer(kind=int32),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>mt</strong></td>
            <td>
                <p>The excitation method.  The options are as follows.</p>
<ul>
<li>
<p>FRF_ACCELERANCE_MODEL: Use an accelerance model.</p>
</li>
<li>
<p>FRF_RECEPTANCE_MODEL: Use a receptance model.</p>
</li>
</ul>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n~7"></span>
              integer(kind=int32),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>
                <p>The model order (# of resonant modes).</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-freq~3"></span>
              real(kind=real64),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>freq</strong></td>
            <td>
                <p>An M-element array containing the excitation frequency values in 
units of rad/s.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rsp"></span>
              complex(kind=real64),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>rsp</strong></td>
            <td>
                <p>An M-element array containing the frequency response to fit.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxp~2"></span>
              real(kind=real64),
            </td>
<td>intent(in),</td>
              <td>optional,</td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>maxp</strong></td>
            <td>
                <p>An optional 3*N-element array that can be used as upper limits on 
the parameter values. If no upper limit is requested for a particular
parameter, utilize a very large value. The internal default is to 
utilize huge() as a value.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-minp~2"></span>
              real(kind=real64),
            </td>
<td>intent(in),</td>
              <td>optional,</td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>minp</strong></td>
            <td>
                <p>An optional 3*N-element array that can be used as lower limits on 
the parameter values. If no lower limit is requested for a particalar
parameter, utilize a very large magnitude, but negative, value. The 
internal default is to utilize -huge() as a value.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-init"></span>
              real(kind=real64),
            </td>
<td>intent(in),</td>
              <td>optional,</td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>init</strong></td>
            <td>
                <p>An optional 3<em>N-element array that, if supplied, provides an initial
guess for each of the 3</em>N model parameters for the iterative solver.
If supplied, this array replaces the peak finding algorithm for
estimating an initial guess.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-stats~2"></span>
              type(regression_statistics),
            </td>
<td>intent(out),</td>
              <td>optional,</td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>stats</strong></td>
            <td>
                <p>An optional 3*N-element array that, if supplied, will be used to
return statistics about the fit for each model parameter.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alpha~10"></span>
              real(kind=real64),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>alpha</strong></td>
            <td>
                <p>The significance level at which to evaluate the confidence intervals.
The default value is 0.05 such that a 95% confidence interval is 
calculated.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-controls~2"></span>
              type(iteration_controls),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>controls</strong></td>
            <td>
                <p>An optional input providing custom iteration controls.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-settings~2"></span>
              type(lm_solver_options),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>settings</strong></td>
            <td>
                <p>An optional input providing custom settings for the solver.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~2"></span>
              type(convergence_info),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                <p>An optional output that can be used to gain information about the 
iterative solution and the nature of the convergence.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-err~32"></span>
              class(errors),
            </td>
<td>intent(inout),</td>
              <td>optional,</td>            <td>
              target
            </td>
            <td>::</td>
            <td><strong>err</strong></td>
            <td>
                <p>An optional errors-based object that if provided 
can be used to retrieve information relating to any errors 
encountered during execution. If not provided, a default 
implementation of the errors class is used internally to provide 
error handling. Possible errors and warning messages that may be 
encountered are as follows.</p>
<ul>
<li>
<p>DYN_MEMORY_ERROR: Occurs if there are issues allocating memory.</p>
</li>
<li>
<p>DYN_ARRAY_SIZE_ERROR: Occurs if freq and rsp are not the same size.</p>
</li>
<li>
<p>DYN_UNDERDEFINED_PROBLEM_EROR: Occurs if the requested model 
     order is too high for the number of data points available.</p>
</li>
<li>
<p>DYN_TOLERANCE_TOO_SMALL_ERROR: Occurs if the requested solver 
     tolerance is too small to be practical for this problem.</p>
</li>
<li>
<p>DYN_TOO_FEW_ITERATIONS_ERROR: Occurs if convergence cannot be 
     achieved in the allowed number of solver iterations.</p>
</li>
</ul>
            </td>
        </tr>
    </tbody>
  </table>

      <h3>Return Value
        <small>
          <span class="anchor" id="variable-rst~110"></span>
          real(kind=real64), allocatable, dimension(:)
        </small>
      </h3>
      <p>An array containing the model parameters stored as <script type="math/tex; mode=display"> \left[ A_{1}, 
\omega_{n1}, \zeta_{1}, A_{2}, \omega_{n2}, \zeta_{2} ... \right] </script>.</p>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>DYNAMICS was developed by Jason Christopherson<br>&copy; 2025 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-05-23 16:25            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>